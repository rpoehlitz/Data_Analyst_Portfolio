# Load required packages
library(dplyr)
library(randomForest)
library(caret)

# Import EPL data with shots and goal data
epl_data <- read.csv("epl_data.csv") 

# Create expected goals model
epl_model <- randomForest(x = select(epl_data, -goals), 
                          y = epl_data$goals, 
                          ntree = 500,
                          mtry = sqrt(ncol(epl_data)-1))

# Summarize model performance
print(epl_model)
plot(epl_model)
rmse <- sqrt(mean((epl_data$goals - predict(epl_model, epl_data))^2)) 
print(paste("Root Mean Squared Error:", round(rmse, 2)))

# Make predictions on new data
new_data <- data.frame(shots = c(7, 3, 10), 
                       xG = c(1.2, 0.5, 2.1))
predictions <- predict(epl_model, new_data)
print(predictions)
